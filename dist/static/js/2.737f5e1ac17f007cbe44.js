webpackJsonp([2],{"0jVE":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("BO1k"),n=a.n(r),o=a("Dd8w"),i=a.n(o),s=a("gNfH"),l=(a("fAxu"),a("h+p8")),d=a("NYxO"),u=a("4naa"),f=a.n(u),c={data:function(){return{org_load:!1,disabledSub:!1,id:this.$route.params.id||"",app_attr:{},formValidate:{type:[{required:!0,message:"应用分类不能为空",trigger:"change"}],name:[{required:!0,message:"应用名称不能为空",trigger:"blur"}],code:[{required:!0,message:"应用编号不能为空",trigger:"blur"}],proAppTypeId:[{required:!0,message:"应用类型不能为空",trigger:"blur"}]},formData:{}}},computed:{state:function(){return this.initData(),this.$route.query.edit||!1},title:function(){var t=this.state?"编辑应用":"应用详情";return this.id?t:"新增应用"},formConfig:function(){return[{name:"应用分类",type:"select",data:"type",required:!0,options:f.a.TYPE_APP_ATTR,placeholder:"请选择账户类型",readonly:!this.state},{name:"应用名称",type:"string",data:"name",required:!0,placeholder:"请填写应用名称",readonly:!this.state},{name:"应用编号",type:"string",data:"code",required:!0,placeholder:"请填写应用编号",options:this.app_attr,readonly:this.id},{name:"应用类型",type:"select",data:"proAppTypeId",required:!0,placeholder:"请选择应用类型",options:this.app_attr,readonly:!this.state},{name:"排序",type:"string",data:"sortNum",placeholder:"请填写排序",readonly:!this.state},{name:"资源路径",type:"string",data:"url",placeholder:"请填写资源路径",readonly:!this.state},{name:"备注",type:"text",data:"remark",placeholder:"请填写备注",readonly:!this.state},{name:"图标",type:"file",data:"logoFile",readonly:!this.state,defuld:[],action:"/portal/pub/comm/uploadimage",format:["jpg","jpeg","png"],maxSize:5120,maxLength:1}]}},methods:i()({},Object(d.b)(["appUpdate","appInfo","typeAppAttr","typeOrgList","typeAreaList","typeOrgList"]),{subForm:function(){var t=this;this.$refs.group.subForm().then(function(e){t.disabledSub=!0,e.logoFile.length&&(e.logo=e.logoFile[0].id),t.id&&(e.id=t.id),t.appUpdate(e).then(function(e){t.disabledSub=!1,t.$Message.success({content:"保存成功"}),t.$router.push({name:"应用管理"})},function(e){t.disabledSub=!1,t.formData.sortNum=100})},function(t){console.error(t)})},initData:function(){var t=this;this.id&&this.appInfo({id:this.id}).then(function(e){var a=e.content;t.formData=a,a.logoFile&&a.logoFile.id&&(t.formData.logoFile=[a.logoFile])})},backData:function(){var t=this;this.state?this.$Modal.confirm({content:"取消编辑将不保存数据",onOk:function(){t.$router.push({name:"应用管理"})}}):this.$router.go(-1)},gotoState:function(t){var e={name:"用户信息",params:{id:this.id}};t&&(e.query={edit:1}),this.$router.push(e)}}),created:function(){var t=this;this.typeAppAttr().then(function(e){var a={},r=!0,o=!1,i=void 0;try{for(var s,l=n()(e.content);!(r=(s=l.next()).done);r=!0){var d=s.value;a[d.id]=d.name}}catch(t){o=!0,i=t}finally{try{!r&&l.return&&l.return()}finally{if(o)throw i}}t.app_attr=a})},components:{TopToolBar:s.a,FormGroup:l.a}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("top-tool-bar",{attrs:{title:t.title}},[a("span",{attrs:{slot:"btn"},slot:"btn"},[a("Button",{on:{click:t.backData}},[t._v(t._s(t.state?"取消":"返回"))]),t._v(" "),t.state?a("Button",{attrs:{type:"primary",disabled:t.disabledSub},on:{click:t.subForm}},[t._v("保存")]):t._e()],1),t._v(" "),a("span",{attrs:{slot:"content"},slot:"content"},[a("strong",{staticClass:"help"},[t._v("说明")]),t._v(" "),a("p",[t._v("\n          无\n          ")])])]),t._v(" "),a("form-group",{ref:"group",attrs:{form:t.formData,config:t.formConfig,validate:t.formValidate}})],1)},staticRenderFns:[]},m=a("VU/8")(c,p,!1,null,null,null);e.default=m.exports},PL6z:function(t,e){},fAxu:function(t,e,a){"use strict";var r={validateIdCard:function(t,e,a){if(/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(e)){if(!a)return!0;a()}else{if(!a)return!1;a(new Error("身份证格式不正确"))}},validatePhone:function(t,e,a){if(/(^1[3|4|5|7|8]\d{9}$)|(^09\d{8}$)/.test(e)){if(!a)return!0;a()}else{if(!a)return!1;a(new Error("手机号码格式不正确"))}},validateMail:function(t,e,a){if(/^\w{3,}@\w+(\.\w+)+$/.test(e)){if(!a)return!0;a()}else{if(!a)return!1;a(new Error("邮箱格式不正确"))}},validateNum:function(t,e,a){if(/^(0.[1-9]*||[1-9][0-9]?||[1-9][0-9]*.[0-9]+)$/.test(e)){if(!a)return!0;a()}else{if(!a)return!1;a(new Error("数字格式不正确"))}},validateInt:function(t,e,a){if(/[0-9]+/.test(e)){if(!a)return!0;a()}else{if(!a)return!1;a(new Error("整数格式不正确"))}},validateImg:function(t){return!!/\.(jpg|bmp|gif|ico|pcx|jpeg|tif|png|raw|tga)$/gi.test(t)},validateDoc:function(t){return!!/\.(doc|docx)$/gi.test(t)}};e.a=r},"h+p8":function(t,e,a){"use strict";var r=a("//Fk"),n=a.n(r),o=a("BO1k"),i=a.n(o),s=a("oUO/"),l=a("dlmu"),d=(a("YK/q"),{props:{form:{type:Object},config:{type:Array,required:!0},validate:{type:Object}},data:function(){var t=!0,e=!1,a=void 0;try{for(var r,n=i()(this.config);!(t=(r=n.next()).done);t=!0){var o=r.value,s=this.form[o.data]||o.defuld||"";this.$set(this.form,o.data,s)}}catch(t){e=!0,a=t}finally{try{!t&&n.return&&n.return()}finally{if(e)throw a}}return{formData:this.form,pic:"",viewerContainer:""}},watch:{form:function(t){this.setFormData()}},mounted:function(){var t=this,e=document.createElement("img");this.viewerContainer=new l.a(e,{url:function(e){return t.pic}})},methods:{setFormData:function(t){var e=!0,a=!1,r=void 0;try{for(var n,o=i()(this.config);!(e=(n=o.next()).done);e=!0){var s=n.value,l=this.form[s.data]||s.defuld||"";this.formData[s.data]=l}}catch(t){a=!0,r=t}finally{try{!e&&o.return&&o.return()}finally{if(a)throw r}}},resetData:function(t,e){var a=!0,r=!1,n=void 0;try{for(var o,s=i()(this.config);!(a=(o=s.next()).done);a=!0){var l=o.value;e&&e[l.data]?t[l.data]=e[l.data]:t[l.data]=l.defuld||""}}catch(t){r=!0,n=t}finally{try{!a&&s.return&&s.return()}finally{if(r)throw n}}return t},setValue:function(t){t.fn(this.formData[t.data],this.$refs.form.validateField)},subForm:function(){var t=this;return this.$refs.form.validate().then(function(e){if(e){var a=!1,r=!0,o=!1,s=void 0;try{for(var l,d=i()(t.config);!(r=(l=d.next()).done);r=!0){var u=l.value;if("file"==u.type&&u.required&&!t.formData[u.data].length){t.$Message.error({content:u.name+"内部不能为空！"}),a=!0;break}}}catch(t){o=!0,s=t}finally{try{!r&&d.return&&d.return()}finally{if(o)throw s}}return a?n.a.reject(t.formData):n.a.resolve(t.formData)}return n.a.reject(t.formData)})},resetForm:function(){return this.$refs.form.resetFields()},uploadFile:function(t,e,a,r){this.formData[t]=r.map(function(t){return t.response?t.response.content:t})},lookFile:function(t){t.name.replace(/\.[jpg|bmp|gif|ico|pcx|jpeg|tif|png|raw|tga]$/gi)?(this.pic=t.url,this.viewerContainer.show()):window.open(t.url)},errorFileFormat:function(t,e,a){this.$Modal.error({content:t.name+":不支持此格式!请选择"+t.format})},errorFileMax:function(t,e,a){this.$Modal.error({content:t.name+":超过指定大小！最大为"+t.max+"kb"})},errorFileLength:function(t){var e=""|t.maxLength,a=this.formData[t.data].length;if(e&&e<=a)return this.$Modal.error({content:t.name+":最大上传数目为"+e}),!1}},components:{InputItem:s.a}}),u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Form",{ref:"form",attrs:{model:t.form,rules:t.validate,inline:""}},[a("Row",{staticClass:"form-group",attrs:{type:"flex"}},t._l(t.config,function(e){return a("Col",{key:e.index,staticClass:"form-group_item",attrs:{span:e.span?e.span:24}},[a("Row",{staticClass:"form-group_row",attrs:{type:"flex"}},[a("Col",{staticClass:"label form-group_col"},[e.required?a("span",{staticClass:"required"},[t._v("*")]):t._e(),t._v("\n             "+t._s(e.name)+"\n           ")]),t._v(" "),a("Col",{staticClass:"form-group_col form-group_col--auto"},[e.readonly&&"select"===e.type?a("div",[t._v("\n               "+t._s(e.options[t.formData[e.data]]||"")+"\n           ")]):e.readonly&&"file"!==e.type?a("div",{staticClass:"form-group_text--pre"},[t._v(t._s(e.read||t.form[e.data]))]):a("FormItem",{class:e.readonly?"readonly":"",attrs:{prop:e.data}},["trigger"===e.type?a("Input",{attrs:{placeholder:e.placeholder,readonly:"",icon:"ios-clock-outline"},model:{value:t.formData[e.data],callback:function(a){t.$set(t.formData,e.data,a)},expression:"formData[item.data]"}},[a("Button",{attrs:{slot:"append",icon:e.icon},on:{click:function(a){t.setValue(e)}},slot:"append"})],1):"file"===e.type?a("Upload",{class:e.readonly?"readonly":"",attrs:{action:e.action,"default-file-list":t.formData[e.data],"on-success":t.uploadFile.bind(this,e.data),"on-remove":t.uploadFile.bind(this,e.data,{}),"max-size":e.maxSize,"on-preview":t.lookFile,format:e.format||[],"before-upload":t.errorFileLength.bind(this,e),"on-format-error":t.errorFileFormat.bind(this,e),"on-exceeded-size":t.errorFileMax.bind(this,e)}},[e.readonly?t._e():a("Button",{attrs:{disabled:e.disabled,type:"ghost"}},[t._v("上传文件")])],1):a("input-item",{attrs:{options:e.options,type:e.type,disabled:e.disabled,readonly:e.readonly,placeholder:e.placeholder,"load-data":e.loadData,fn:e.fn,loading:e.loading},model:{value:t.formData[e.data],callback:function(a){t.$set(t.formData,e.data,a)},expression:"formData[item.data]"}})],1),t._v(" "),t._l(e.cell,function(e){return a("div",{key:e.index},["string"==e.type?a("p",[a("span",[t._v(t._s(e.name))]),t._v(" "),a("span",{class:e.class||"",style:e.style},[t._v(t._s(t.formData[e.data]||e.default)+"\n                 ")])]):t._e()])})],2)],1)],1)}))],1)},staticRenderFns:[]};var f=a("VU/8")(d,u,!1,function(t){a("PL6z")},null,null);e.a=f.exports}});